<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Luxury Paradise Streaming</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #0c0c1d, #1a1a3d);
            color: #fff;
            min-height: 100vh;
            overflow-x: hidden;
        }
        
        /* [TUTTO IL CSS PRECEDENTE RIMANE IDENTICO] */
        /* ... (mantieni tutto lo stile esistente) ... */
        
        /* Aggiungi questo nuovo stile per le serie TV */
        .tv-badge {
            background: rgba(255, 107, 107, 0.8);
        }
    </style>
</head>
<body>
    <div id="main-content">
        <!-- [TUTTO L'HTML PRECEDENTE RIMANE IDENTICO] -->
        <!-- ... (mantieni tutta la struttura esistente) ... -->
        
        <!-- Aggiungi questa nuova sezione per le serie TV -->
        <div class="section-title" id="tv-title">
            <h2>Serie TV Popolari</h2>
            <a href="#" class="see-all">Vedi tutti &gt;</a>
        </div>
        
        <div class="movies-grid" id="tv-series">
            <div class="loader"></div>
        </div>
    </div>
    
    <!-- [IL PLAYER MODALE ESISTENTE RIMANE IDENTICO] -->

    <script>
        // Configurazione API
        const TMDB_API_KEY = 'ab9127383e0f6c02751abecfc7a89a3b';
        const TMDB_API_URL = 'https://api.themoviedb.org/3';
        const TMDB_IMG_PATH = 'https://image.tmdb.org/t/p/w500';
        const ANILIST_API = 'https://graphql.anilist.co';
        const CONSUMET_API = 'https://api.consumet.org/anime/gogoanime';
        
        // Elementi DOM
        const tvSeriesGrid = document.getElementById('tv-series');
        
        // [TUTTE LE FUNZIONI ESISTENTI RIMANGONO]
        
        // Aggiungi questa nuova funzione per ottenere le serie TV
        async function getPopularTVSeries() {
            try {
                const response = await fetch(`${TMDB_API_URL}/tv/popular?api_key=${TMDB_API_KEY}&language=it-IT`);
                const data = await response.json();
                return data.results;
            } catch (error) {
                console.error('Errore nel caricamento delle serie TV:', error);
                return [];
            }
        }

        // Modifica la funzione displayMovies per gestire anche le serie TV
        function displayMedia(items, container, type = 'movie') {
            container.innerHTML = '';
            
            if (!items || items.length === 0) {
                container.innerHTML = '<p class="no-results">Nessun contenuto disponibile</p>';
                return;
            }
            
            items.forEach(item => {
                const card = document.createElement('div');
                card.className = 'movie-card';
                
                const badgeType = type === 'tv' ? 'tv-badge' : 
                                type === 'anime' ? 'anime-badge' : '';
                
                const title = type === 'movie' ? item.title : 
                            type === 'tv' ? item.name : 
                            item.title;
                
                const year = type === 'movie' ? item.release_date :
                            type === 'tv' ? item.first_air_date :
                            item.year;
                
                card.innerHTML = `
                    <div class="type-badge ${badgeType}">
                        ${type === 'tv' ? 'SERIE' : type === 'anime' ? 'ANIME' : 'FILM'}
                    </div>
                    <img src="${type === 'anime' ? item.image : TMDB_IMG_PATH + (item.poster_path || '')}" 
                         alt="${title}" 
                         onerror="this.src='https://via.placeholder.com/300x450?text=Copertina+non+disponibile'">
                    <div class="movie-info" style="${type === 'anime' ? `border-top: 3px solid ${item.color || '#4ecdc4'}` : ''}">
                        <div class="movie-title">${title}</div>
                        <div class="movie-year">${year ? year.substring(0, 4) : 'N/A'}</div>
                        <div class="movie-rating">
                            <i class="fas fa-star"></i>
                            ${type === 'anime' ? item.score : item.vote_average ? item.vote_average.toFixed(1) : 'N/A'}/10
                        </div>
                    </div>
                `;
                
                card.addEventListener('click', async () => {
                    if (type === 'anime') {
                        // Gestione anime
                        const loadingEpisodes = document.createElement('div');
                        loadingEpisodes.className = 'loader';
                        container.appendChild(loadingEpisodes);
                        
                        try {
                            const searchResults = await searchAnime(item.title);
                            if (searchResults.results.length > 0) {
                                const consumetAnime = searchResults.results[0];
                                const episodes = await getAnimeEpisodes(consumetAnime.id);
                                
                                if (episodes.length > 0) {
                                    currentAnime = { ...item, consumetId: consumetAnime.id };
                                    currentEpisodes = episodes;
                                    openPlayer();
                                } else {
                                    alert('Nessun episodio disponibile per questo anime');
                                }
                            } else {
                                alert('Anime non trovato sul servizio di streaming');
                            }
                        } catch (error) {
                            console.error('Errore:', error);
                            alert('Errore nel caricamento');
                        } finally {
                            loadingEpisodes.remove();
                        }
                    } else if (type === 'tv') {
                        // Gestione serie TV
                        alert(`Serie TV selezionata: ${item.name}\n\nFunzionalità di streaming per serie TV non ancora implementata`);
                    } else {
                        // Gestione film
                        alert(`Film selezionato: ${item.title}\n\nFunzionalità di streaming per film non ancora implementata`);
                    }
                });
                
                container.appendChild(card);
            });
        }

        // Aggiorna l'inizializzazione
        window.addEventListener('DOMContentLoaded', async () => {
            // Carica film
            trendingMoviesData = await getTrendingMovies();
            displayMedia(trendingMoviesData.slice(0, 6), trendingMoviesGrid, 'movie');
            
            // Carica nuove uscite
            newReleasesData = await getNewReleases();
            displayMedia(newReleasesData.slice(0, 6), newReleasesGrid, 'movie');
            
            // Carica anime
            await getPopularAnime();
            
            // Carica serie TV
            const tvSeries = await getPopularTVSeries();
            displayMedia(tvSeries.slice(0, 6), tvSeriesGrid, 'tv');
        });

        // [TUTTO IL RESTO DEL CODICE RIMANE IDENTICO]
    </script>
</body>
</html>
